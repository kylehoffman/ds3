<!DOCTYPE html>
<html>
  <head>
    <title>Cybernetic Forest Rebirth</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>

  <body>
    <a-scene>
      <!-- Assets -->
      <a-assets>
        <video
          id="video360"
          src="Cybernetic_Forest_Rebirth_Video_Generation.mp4"
          loop
          muted
          playsinline
          crossorigin="anonymous">
        </video>
      </a-assets>

      <!-- 360° Background -->
      <a-videosphere src="#video360" rotation="0 -90 0"></a-videosphere>

      <!-- BOX 1 (center front) -->
      <a-box id="box1" position="0 1.6 -3" color="#00CED1" depth="0" height="0.4" width="0.4"></a-box>

      <!-- TEXT 1 -->
      <a-text
        id="text1"
        value="The forest is reborn as biotech. 
Trees pulse with glowing veins of circuitry, metallic leaves shimmer, and roots merge into cables feeding the water."
        position="0 2.1 -3"
        align="center"
        color="#FFF"
        width="4"
        visible="false"
        scale="0.75 0.75 0.75"
        look-at="[camera]">
      </a-text>

      <!-- BOX 2 (slightly right) -->
      <a-box id="box2" position="2.5 1.6 -3" color="#FF4500" depth="0" height="0.4" width="0.4" visible="false"></a-box>

      <!-- TEXT 2 -->
      <a-text
        id="text2"
        value="Floating drones hum overhead, scanning the area as neon-orange and violet sun sets.
A lone humanoid silhouette gazes at the glowing forest."
        position="2.5 2.3 -3"
        align="center"
        color="#FFF"
        width="4"
        visible="false"
        scale="1 1 1"
        look-at="[camera]">
      </a-text>

      <!-- BOX 3 (behind user, 180°) -->
      <a-box id="box3" position="-2.5 1.6 -3" color="#FFD700" depth="0" height="0.4" width="0.4" visible="false"></a-box>

      <!-- TEXT 3 -->
      <a-text
        id="text3"
        value="The forest sheds glowing data fragments — red, gold, copper holographic leaves dissolve into the air.
Each leaf becomes a data packet, merging into streams of light feeding the ground or the lake, symbolizing death transforming into digital life."
        position="-2.5 2.5 -3"
        align="center"
        color="#FFF"
        width="4"
        visible="false"
        scale="1 1 1"
        look-at="[camera]">
      </a-text>

      <!-- Camera + cursor -->
      <a-entity camera look-controls position="0 1.6 0">
        <a-entity 
          cursor="fuse: false"
          position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015"
          material="color: white; shader: flat">
        </a-entity>
      </a-entity>

      <a-entity id="uiPanelRoot" position="-0.8 1.0 -2.0" rotation="0 0 0">
        <!-- Button: Present -->
        <a-entity id="btnPresent" ui-button="url: fall_present.html; label: Present" geometry="primitive: plane; width: 0.28; height: 0.08" material="transparent: true; opacity: 0; shader: flat" position="0 0 0.001">
          <a-image class="bg" width="0.28" height="0.08" material="shader: flat; color: #2C3E50; opacity: 0.70; transparent: true" position="0 0 0.0005"></a-image>
          <a-entity text="value: Present; color: #FFFFFF; align: center; baseline: center; width: 1.6" position="0 0 0.0015"></a-entity>
          <a-entity class="progress" geometry="primitive: ring; radiusInner: 0.001; radiusOuter: 0.011; segmentsTheta: 64" material="color: #FFFFFF; opacity: 0.9; shader: flat" position="0 0 0.002" scale="0 0 0"></a-entity>
        </a-entity>

        <!-- Button: Past -->
        <a-entity id="btnPast" ui-button="url: fall_past.html; label: Past" geometry="primitive: plane; width: 0.28; height: 0.08" material="transparent: true; opacity: 0; shader: flat" position="0 -0.11 0.001">
          <a-image class="bg" width="0.28" height="0.08" material="shader: flat; color: #2C3E50; opacity: 0.70; transparent: true" position="0 0 0.0005"></a-image>
          <a-entity text="value: Past; color: #FFFFFF; align: center; baseline: center; width: 1.6" position="0 0 0.0015"></a-entity>
          <a-entity class="progress" geometry="primitive: ring; radiusInner: 0.001; radiusOuter: 0.011; segmentsTheta: 64" material="color: #FFFFFF; opacity: 0.9; shader: flat" position="0 0 0.002" scale="0 0 0"></a-entity>
        </a-entity>

        <!-- Button: Future -->
        <a-entity id="btnFuture" ui-button="url: fall_future.html; label: Future" geometry="primitive: plane; width: 0.28; height: 0.08" material="transparent: true; opacity: 0; shader: flat" position="0 -0.22 0.001">
          <a-image class="bg" width="0.28" height="0.08" material="shader: flat; color: #2C3E50; opacity: 0.70; transparent: true" position="0 0 0.0005"></a-image>
          <a-entity text="value: Future; color: #FFFFFF; align: center; baseline: center; width: 1.6" position="0 0 0.0015"></a-entity>
          <a-entity class="progress" geometry="primitive: ring; radiusInner: 0.001; radiusOuter: 0.011; segmentsTheta: 64" material="color: #FFFFFF; opacity: 0.9; shader: flat" position="0 0 0.002" scale="0 0 0"></a-entity>
        </a-entity>

        <!-- Button: Home -->
        <a-entity id="btnHome" ui-button="url: index.html; label: Home" geometry="primitive: plane; width: 0.28; height: 0.08" material="transparent: true; opacity: 0; shader: flat" position="0 -0.33 0.001">
          <a-image class="bg" width="0.28" height="0.08" material="shader: flat; color: #2C3E50; opacity: 0.70; transparent: true" position="0 0 0.0005"></a-image>
          <a-entity text="value: Home; color: #FFFFFF; align: center; baseline: center; width: 1.6" position="0 0 0.0015"></a-entity>
          <a-entity class="progress" geometry="primitive: ring; radiusInner: 0.001; radiusOuter: 0.011; segmentsTheta: 64" material="color: #FFFFFF; opacity: 0.9; shader: flat" position="0 0 0.002" scale="0 0 0"></a-entity>
        </a-entity>
      </a-entity>
    </a-scene>

    <script>
      function fadeTo(url, dur = 600) {
        const fade = document.getElementById('screenFade');
        if (!fade) { window.location.href = url; return; }
        fade.setAttribute('animation__fadeout', {
          property: 'material.opacity',
          to: 1,
          dur,
          easing: 'easeInOutQuad'
        });
        fade.addEventListener('animationcomplete__fadeout', () => {
          window.location.href = url;
        }, { once: true });
      }

      AFRAME.registerComponent('ui-button', {
        schema: { url: { type: 'string' }, label: { type: 'string', default: '' } },
        init: function () {
          const el = this.el;
          const data = this.data;
          const baseTint = '#2C3E50';
          const hoverTint = '#4AA3FF';
          const hoverTime = 3000; // 3 seconds hover to activate
          let hoverTimer = null;

          const bg = el.querySelector('.bg');
          const progress = el.querySelector('.progress');

          el.addEventListener('mouseenter', () => {
            if (bg) bg.setAttribute('material', 'color', hoverTint);
            el.object3D.scale.set(1.05, 1.05, 1);

            if (progress) {
              progress.setAttribute('scale', '0.001 0.001 0.001');
              progress.setAttribute('animation__grow', {
                property: 'scale',
                to: '1 1 1',
                dur: hoverTime,
                easing: 'linear'
              });
            }

            hoverTimer = setTimeout(() => {
              if (data.url) fadeTo(data.url, 600);
            }, hoverTime);
          });

          el.addEventListener('mouseleave', () => {
            if (bg) bg.setAttribute('material', 'color', baseTint);
            el.object3D.scale.set(1, 1, 1);
            if (progress) {
              progress.removeAttribute('animation__grow');
              progress.setAttribute('scale', '0 0 0');
            }
            if (hoverTimer) clearTimeout(hoverTimer);
          });
        }
      });

      document.addEventListener('DOMContentLoaded', () => {
        const boxes = [
          { box: '#box1', text: '#text1', next: '#box2' },
          { box: '#box2', text: '#text2', next: '#box3' },
          { box: '#box3', text: '#text3' }
        ];
        boxes.forEach(({ box, text, next }) => {
          const b = document.querySelector(box);
          const t = document.querySelector(text);
          const n = next ? document.querySelector(next) : null;
          if (!b) return;

          b.addEventListener('mouseenter', () => {
            if (t) t.setAttribute('visible', true);
            if (n) setTimeout(() => n.setAttribute('visible', true), 1500);
          });
          b.addEventListener('mouseleave', () => {
            if (t) t.setAttribute('visible', false);
          });
        });
      });

      window.addEventListener('load', () => {
        const video = document.querySelector('#video360');
        if (video) video.play().catch(err => console.warn('Autoplay prevented:', err));
      });
    </script>
  </body>
</html>
